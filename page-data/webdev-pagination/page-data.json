{"componentChunkName":"component---src-templates-blog-post-js","path":"/webdev-pagination/","result":{"data":{"site":{"siteMetadata":{"title":"Ken's Feynman Dump"}},"markdownRemark":{"id":"bf562099-94fe-5c66-931f-b4e6896e5d18","excerpt":"Stuff taken directly from my conversations with chatgpt/Gemini because I'm too dumb to understand basic computer science Pagination is the standard way ofâ€¦","html":"<h2>Stuff taken directly from my conversations with chatgpt/Gemini because I'm too dumb to understand basic computer science</h2>\n<p>Pagination is the standard way of \"paging\" and batching listed data into sections for consumption. Imagine 1000 items in a list, we separate these by pages, and in web development the \"default\" pattern is using OFFSETS.</p>\n<p>Logically we can think of offsets as \"start counting AFTER the given OFFSET\" so if the offset is 100, we begin counting after item 100. How this translates to code however, at least in Spring Boot -> Hibernate -> SQL, the resulting SQL becomes something like</p>\n<p><code class=\"language-text\">SELECT * FROM users LIMIT 10 OFFSET 100</code></p>\n<p>The two biggest cons to this strategy are:</p>\n<ul>\n<li>What happens if a new piece of data is inserted in that first 100?</li>\n<li>The SQL above has to fetch 110 rows and then throws away the first 100! As the user goes deeper in pages, it gets worse and worse</li>\n</ul>\n<p>This quickly became unscalable with the advent of the \"infinite scroll\" in the early aughts. Developers at Twitter and Slack were some of the first companies to propose something different in application code.</p>\n<p>Let's consider HOW you would solve this problem in raw SQL, assuming we have an ORDERED list, you could say something like \"Hey give me all the items after item 20\" right? You'd need <em>some</em> sort of sort key though to intend that you know what to search.</p>\n<p><code class=\"language-text\">SELECT * FROM users WHERE user_id > 20\"</code></p>\n<p><a href=\"https://slack.engineering/evolving-api-pagination-at-slack/\">https://slack.engineering/evolving-api-pagination-at-slack/</a></p>\n<p>(The above is an example in which sequential ids are used for user_ids)</p>\n<p>Talking to gemini, my brain is too slow to even imagine writing this pseudo code:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// How they hand-rolled the 'Tie-Breaker' logic\npublic String generateCursor(Product p) {\n    // Combine the sort field (Price) and the Unique ID\n    String raw = \"price:\" + p.getPrice() + \"|id:\" + p.getId();\n    return Base64.encode(raw);\n}\n\npublic Query buildQuery(String encodedCursor) {\n    Cursor c = decode(encodedCursor);\n    // The \"Greater Than\" logic you mentioned!\n    return \"SELECT * FROM products \" +\n           \"WHERE (price > :p) OR (price = :p AND id > :id) \" +\n           \"ORDER BY price ASC, id ASC LIMIT 20\";\n}</code></pre></div>\n<p>Note that to make this sorting deterministic it's often best to have more than one column as part of the query:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 220px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5b7fa33fe3d8c217e8204b2ef0a37dc9/c8042/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.54430379746836%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABwUlEQVR42o1Ui07CQBDk/z9KjYpQbBDkEQhvSRFB3lD6HndOrhHaCkmXu2aX6czt7OXCMII88IMoEYEkJIVIfljDVb0jvT6UgtzedtDtj7A9OHD8CEcvhO0GkAfz5Qad7hBf8yWGHxbG1hTWdIbJdI6D46vav+H6IXKbnY23ag1cPQFxmBQ07r8F8L3eROW9jnqzhZJZRtEwUa7UsBMCrhBgvQ5XIseNACeSzumLlBpI3pcNI+B7hERtDEg2y/VWMbwsYG612Sk23DNsSpU1E/Bw9FAoltBotmOWWvJ8scbD4zNeCgY6vYFilgV2JpkMCHxZQDZkztjbbiZQAjA4WSftDGkR5ri/CZDMjJIJ47Ucd46yKM+afOHu/hFFyduOdyND+bP1OVMeo0R9hgSm1MFojNHY+vfsEpL1FJx1WML7I/ka2JnkTneA/uBDNUZLZpdpp3anh/5wfDtD2wlQb7RQrTXOzpBmn84WyItlzHIl1QXZXT4Nd7LLvxeEJ2vaJGUw9NXMciJ0UzQYvUdzaz9e82J8hqZZkWkoxReEkqwmZaXkPuULKBivyj76AvlXMr98dP3USeH1ptlt98erDH8AhogkSL6mNJ0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt text\"\n        title=\"\"\n        src=\"/static/5b7fa33fe3d8c217e8204b2ef0a37dc9/c8042/image.png\"\n        srcset=\"/static/5b7fa33fe3d8c217e8204b2ef0a37dc9/c26ae/image.png 158w,\n/static/5b7fa33fe3d8c217e8204b2ef0a37dc9/c8042/image.png 220w\"\n        sizes=\"(max-width: 220px) 100vw, 220px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">If your cursor is just last_seen_name = 'Bob', and you ask the database for WHERE first_name > 'Bob' LIMIT 1, the database skips both Bobs and goes straight to Charlie. You just missed the second Bob (ID 103) entirely!\n\nBy adding the ID as the \"tie-breaker,\" your cursor becomes a tuple: ('Bob', 102).\n\nNow the logic is: \"Give me the next person who has a name 'greater' than Bob OR whose name is Bob but their ID is greater than 102.\"</code></pre></div>\n<p>This might look familiar in indexing, it's a composite index made up of two columns.</p>","frontmatter":{"title":"Pagination","date":"February 03, 2026","description":"Historical pagination in Spring Boot and how it was improved in application code"}},"previous":{"fields":{"slug":"/db-pt3/"},"frontmatter":{"title":"Database Fundamentals - Optimistic locking"}},"next":null},"pageContext":{"id":"bf562099-94fe-5c66-931f-b4e6896e5d18","previousPostId":"2f3ffb4e-9362-5424-bc5b-a680b0b759de","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}